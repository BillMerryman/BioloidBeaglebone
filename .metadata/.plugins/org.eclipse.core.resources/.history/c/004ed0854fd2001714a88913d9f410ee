/*
 * motionProcessor.c
 *
 *  Created on: Nov 25, 2017
 *      Author: Bill
 */

#include <stdio.h>
#include <errno.h>
#include "motionProcessor.h"
#include "pruInterop.h"
#include "pru.h"

PRU_INTEROP_1_DATA* PRUInterop1Data;
MOTION_PAGE *motionPage;
volatile unsigned int *motionPageReadyFlag;
int key = 0;

void motionProcessorInitialize(const char *filename)
{

	PRU_INTEROP_0_DATA* PRUInterop0Data = &(getPRUInteropData()->PRUInterop0Data);

	cvSetData(sourceImage, (void *)(&(PRUInterop1Data->imageData)), sourceImage->widthStep);

	motionPageReadyFlag = &(PRUInterop0Data->motionPageReadyFlag);
	*motionPageReadyFlag = MOTION_PAGE_NOT_READY;


	motionLoadFile("/root/Desktop/FlexTest.mtn");
	motionPage = &(PRUInterop0Data->motionPage);


}

void motionLoadFile(const char *filename)
{
	FILE *motionFile;

	motionFile = fopen(filename, "rb");
	if (!motionFile) return /*-ENOENT*/;

	fread((void *)motionPageFile, sizeof(byte), sizeof(motionPageFile), motionFile);

	fclose(motionFile);

	return /*0*/;
}

//void motionLoadPage(byte pageNumber, MOTION_PAGE *page)
//{
//	byte *sourcePage = (byte *)(&motionPageFile[pageNumber]);
//	byte *destinationPage = (byte *)page;
//	uint16_t counter;
//
//	for(counter = 0; counter < sizeof(MOTION_PAGE); counter++)
//	{
//		destinationPage[counter] = sourcePage[counter];
//	}
//}



